{"ast":null,"code":"import _objectSpread from\"C:/Users/risha/Music/connect-four-main/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{createContext,useContext,useState,useEffect,useCallback}from'react';import{io}from'socket.io-client';import{jsx as _jsx}from\"react/jsx-runtime\";const SocketContext=/*#__PURE__*/createContext();export const SocketProvider=_ref=>{let{children}=_ref;const[socket,setSocket]=useState(null);const[roomId,setRoomId]=useState(null);const[playerName,setPlayerName]=useState('');const[players,setPlayers]=useState([]);const[gameState,setGameState]=useState(null);const[gameOver,setGameOver]=useState(false);const[winner,setWinner]=useState(null);const[currentPlayer,setCurrentPlayer]=useState('red');const[error,setError]=useState(null);const[connected,setConnected]=useState(false);// Initialize socket connection\nuseEffect(()=>{var _process$env$REACT_AP;const socketUrl=((_process$env$REACT_AP=process.env.REACT_APP_API_URL)===null||_process$env$REACT_AP===void 0?void 0:_process$env$REACT_AP.replace('/api',''))||'http://localhost:5000';const newSocket=io(socketUrl);newSocket.on('connect',()=>{console.log('Connected to server');setConnected(true);setError(null);});newSocket.on('disconnect',()=>{console.log('Disconnected from server');setConnected(false);});newSocket.on('player_joined',data=>{setPlayers(data.players);setGameState(data.gameState);setCurrentPlayer(data.gameState.currentPlayer);});newSocket.on('move_made',data=>{setGameState(_objectSpread(_objectSpread({},gameState),{},{board:data.board}));setCurrentPlayer(data.currentPlayer);setGameOver(data.gameOver);if(data.gameOver){setWinner(data.winner);}});newSocket.on('move_error',data=>{setError(data.message);});newSocket.on('game_reset',data=>{setGameState(data.gameState);setCurrentPlayer(data.gameState.currentPlayer);setGameOver(false);setWinner(null);setPlayers(data.players);});newSocket.on('player_left',data=>{console.log(\"Player \".concat(data.playerId,\" left the room\"));});setSocket(newSocket);return()=>{newSocket.disconnect();};},[]);// Join a room\nconst joinRoom=useCallback((newRoomId,name)=>{if(socket&&socket.connected){setRoomId(newRoomId);setPlayerName(name);socket.emit('join_room',newRoomId,name);}else{setError('Socket not connected');}},[socket]);// Make a move\nconst makeMove=useCallback(column=>{if(socket&&roomId){socket.emit('make_move',roomId,column);}else{setError('Not connected to a room');}},[socket,roomId]);// Reset game\nconst resetGame=useCallback(()=>{if(socket&&roomId){socket.emit('reset_game',roomId);setGameOver(false);setWinner(null);}},[socket,roomId]);// Leave room\nconst leaveRoom=useCallback(()=>{if(socket&&roomId){socket.emit('leave_room',roomId);setRoomId(null);setPlayers([]);setGameState(null);setGameOver(false);setWinner(null);}},[socket,roomId]);const value={socket,connected,roomId,playerName,players,gameState,gameOver,winner,currentPlayer,error,joinRoom,makeMove,resetGame,leaveRoom,setError};return/*#__PURE__*/_jsx(SocketContext.Provider,{value:value,children:children});};export const useSocket=()=>{const context=useContext(SocketContext);if(!context){throw new Error('useSocket must be used within SocketProvider');}return context;};","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useCallback","io","jsx","_jsx","SocketContext","SocketProvider","_ref","children","socket","setSocket","roomId","setRoomId","playerName","setPlayerName","players","setPlayers","gameState","setGameState","gameOver","setGameOver","winner","setWinner","currentPlayer","setCurrentPlayer","error","setError","connected","setConnected","_process$env$REACT_AP","socketUrl","process","env","REACT_APP_API_URL","replace","newSocket","on","console","log","data","_objectSpread","board","message","concat","playerId","disconnect","joinRoom","newRoomId","name","emit","makeMove","column","resetGame","leaveRoom","value","Provider","useSocket","context","Error"],"sources":["C:/Users/risha/Music/connect-four-main/frontend/src/context/SocketContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport { io } from 'socket.io-client';\r\n\r\nconst SocketContext = createContext();\r\n\r\nexport const SocketProvider = ({ children }) => {\r\n  const [socket, setSocket] = useState(null);\r\n  const [roomId, setRoomId] = useState(null);\r\n  const [playerName, setPlayerName] = useState('');\r\n  const [players, setPlayers] = useState([]);\r\n  const [gameState, setGameState] = useState(null);\r\n  const [gameOver, setGameOver] = useState(false);\r\n  const [winner, setWinner] = useState(null);\r\n  const [currentPlayer, setCurrentPlayer] = useState('red');\r\n  const [error, setError] = useState(null);\r\n  const [connected, setConnected] = useState(false);\r\n\r\n  // Initialize socket connection\r\n  useEffect(() => {\r\n    const socketUrl = process.env.REACT_APP_API_URL?.replace('/api', '') || 'http://localhost:5000';\r\n    const newSocket = io(socketUrl);\r\n\r\n    newSocket.on('connect', () => {\r\n      console.log('Connected to server');\r\n      setConnected(true);\r\n      setError(null);\r\n    });\r\n\r\n    newSocket.on('disconnect', () => {\r\n      console.log('Disconnected from server');\r\n      setConnected(false);\r\n    });\r\n\r\n    newSocket.on('player_joined', (data) => {\r\n      setPlayers(data.players);\r\n      setGameState(data.gameState);\r\n      setCurrentPlayer(data.gameState.currentPlayer);\r\n    });\r\n\r\n    newSocket.on('move_made', (data) => {\r\n      setGameState({\r\n        ...gameState,\r\n        board: data.board\r\n      });\r\n      setCurrentPlayer(data.currentPlayer);\r\n      setGameOver(data.gameOver);\r\n      if (data.gameOver) {\r\n        setWinner(data.winner);\r\n      }\r\n    });\r\n\r\n    newSocket.on('move_error', (data) => {\r\n      setError(data.message);\r\n    });\r\n\r\n    newSocket.on('game_reset', (data) => {\r\n      setGameState(data.gameState);\r\n      setCurrentPlayer(data.gameState.currentPlayer);\r\n      setGameOver(false);\r\n      setWinner(null);\r\n      setPlayers(data.players);\r\n    });\r\n\r\n    newSocket.on('player_left', (data) => {\r\n      console.log(`Player ${data.playerId} left the room`);\r\n    });\r\n\r\n    setSocket(newSocket);\r\n\r\n    return () => {\r\n      newSocket.disconnect();\r\n    };\r\n  }, []);\r\n\r\n  // Join a room\r\n  const joinRoom = useCallback((newRoomId, name) => {\r\n    if (socket && socket.connected) {\r\n      setRoomId(newRoomId);\r\n      setPlayerName(name);\r\n      socket.emit('join_room', newRoomId, name);\r\n    } else {\r\n      setError('Socket not connected');\r\n    }\r\n  }, [socket]);\r\n\r\n  // Make a move\r\n  const makeMove = useCallback((column) => {\r\n    if (socket && roomId) {\r\n      socket.emit('make_move', roomId, column);\r\n    } else {\r\n      setError('Not connected to a room');\r\n    }\r\n  }, [socket, roomId]);\r\n\r\n  // Reset game\r\n  const resetGame = useCallback(() => {\r\n    if (socket && roomId) {\r\n      socket.emit('reset_game', roomId);\r\n      setGameOver(false);\r\n      setWinner(null);\r\n    }\r\n  }, [socket, roomId]);\r\n\r\n  // Leave room\r\n  const leaveRoom = useCallback(() => {\r\n    if (socket && roomId) {\r\n      socket.emit('leave_room', roomId);\r\n      setRoomId(null);\r\n      setPlayers([]);\r\n      setGameState(null);\r\n      setGameOver(false);\r\n      setWinner(null);\r\n    }\r\n  }, [socket, roomId]);\r\n\r\n  const value = {\r\n    socket,\r\n    connected,\r\n    roomId,\r\n    playerName,\r\n    players,\r\n    gameState,\r\n    gameOver,\r\n    winner,\r\n    currentPlayer,\r\n    error,\r\n    joinRoom,\r\n    makeMove,\r\n    resetGame,\r\n    leaveRoom,\r\n    setError\r\n  };\r\n\r\n  return (\r\n    <SocketContext.Provider value={value}>\r\n      {children}\r\n    </SocketContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useSocket = () => {\r\n  const context = useContext(SocketContext);\r\n  if (!context) {\r\n    throw new Error('useSocket must be used within SocketProvider');\r\n  }\r\n  return context;\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}